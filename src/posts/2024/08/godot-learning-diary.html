<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2024-08-31 Sat 17:32 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Godot 4 学习日记</title>
<meta name="author" content="saltb0rn" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Godot 4 学习日记</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orga447b45">1. Day -1: First Game</a>
<ul>
<li><a href="#orga74f146">1.1. 心得</a>
<ul>
<li><a href="#org7702f69">1.1.1. Scene 和 Node 和 Script 的关系</a></li>
<li><a href="#orgbb3f225">1.1.2. 什么时候用 Node2D, 什么时候不用 Node2D</a></li>
<li><a href="#org891ae7a">1.1.3. CharacterBody2D 和 AnimatableBody2D 的使用</a></li>
<li><a href="#org25362b4">1.1.4. TileMap (TileMapLayer) 的使用</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org8703f83">2. Day 0: 学习 Node 的工作方式以及文档的查阅</a></li>
<li><a href="#orgc318c74">3. Day 1: 给 Brackeys 的教程例子添加额外功能</a>
<ul>
<li><a href="#org1cce15c">3.1. 视差背景 (Parallax Backgrounds)</a></li>
<li><a href="#orgb842395">3.2. 角色站在平台上时, 按下穿过平台回到下一层</a></li>
<li><a href="#org7969bd8">3.3. 添加 Game Over 界面</a></li>
<li><a href="#org0036613">3.4. 在 Game Over 时禁止用户的部分输入</a></li>
</ul>
</li>
<li><a href="#org9c27bd4">4. Day 2: 游戏开发中的物理</a></li>
<li><a href="#orgfe11ae6">5. Day 3: 给游戏的鼠标时间添加手柄支持</a></li>
<li><a href="#org393525b">6. Day 4: GDQuest 的 Learn 2D Gamedev From Zero With Godot 4 课程学习: M4. TO SPACE AND BEYOND</a></li>
<li><a href="#org6db88de">7. Day 5: GDQuest 的 Learn 2D Gamedev From Zero With Godot 4 课程学习: M5. LOOT IT ALL</a>
<ul>
<li><a href="#orgafffc11">7.1. 一些有趣的知识点</a>
<ul>
<li><a href="#org03820de">7.1.1. L3</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="abstract" id="org4877f8d">
<p>
这里记录了我学习 <code>Godot 4</code> 的轨迹, 以及对学习时的一些疑问进行解答.
</p>

<p>
准确来说这篇文章是日记集, 熟悉 <code>Godot</code> 引擎的功能不是一两天的事情, 因此会分为 <code>Day 0</code>, <code>Day 1</code> 这样的章节,
</p>

<p>
每天进行学习内容输出, 也借此保证自己的学习进度.
</p>

<p>
同时也想尝试新的学习方法, 达到尽可能以最小天数学习并掌握一项技能, 但每天不会超负荷(在精力不足的情况下)地学习.
</p>

<p>
曾经的超负荷学习并不能让我以最小天数掌握一门技能, 反而起到反效果, 伤身又费神, 更加拖慢了学习进度, 而且学习效果也不够好.
</p>

<p>
在不拉长学习进度的前提下学习是能够快速并且好好地掌握一项技能的, 比如明明可以一天内学习完某个知识, 非得拉长到几天, 这样反而容易忘记前几天所学的内容.
</p>

<p>
但人的精力是有限的, 也不可能无限缩短学习进度, 像"必需在多少天只能学习完某某技能"的赶进度式学习是不可取的, 毕竟不同知识的复杂度是不同的, 而且每个人的知识储备也是不一样的,
</p>

<p>
而知识储备会影响一个人的学习和理解速度, 种种因素导致了一个人很难准确估算出学一个技能需要多少时间, 与其这样不如在保证精力充沛的情况下学到哪就到哪, 等休息够了继续上路,
</p>

<p>
直到掌握为止, 相信这个时间不会太长.
</p>

</div>

<div id="outline-container-orga447b45" class="outline-2">
<h2 id="orga447b45"><span class="section-number-2">1.</span> Day -1: First Game</h2>
<div class="outline-text-2" id="text-1">
<blockquote>
<p>
这里 <code>Day -1</code> 是因为在写这篇文章之前就已经学习了 1 天了, <code>Day 0</code> 才是这篇笔记的起稿日期.
</p>
</blockquote>

<p>
第一天跟随着 <code>Brackeys</code> 的 <code>Godot 4</code> 教程: <a href="https://www.youtube.com/watch?v=LOhfqjmasi0">How to make a Video Game - Godot Beginner Tutorial</a>.
</p>

<p>
重点在于熟悉 <code>Godot 4</code> 的一些功能, 视频的内容能够理解的就尽量理解, 不理解先记录下, 做完项目后找答疑.
</p>

<p>
视频长度为一小时 17 分钟, 自己跟下来大概两个小时左右就可以完成, 视频的最后还有一些对游戏的拓展建议, 这个我留到后面有空做了.
</p>

<p>
这个是必做的, 因为熟悉引擎对于新手来说是很重要的事情.
</p>

<blockquote>
<p>
在我看到这个视频的时候, <code>Godot 4</code> 刚发布 <code>4.3</code> 版本了, 而视频中使用的 <code>Godot 4</code> 是 <code>4.2</code> 版本的,
</p>

<p>
主要差别在与 <code>4.2</code> 中的 <code>TileMap</code> 在 <code>4.3</code> 中被移除了, <code>TileMap</code> 的 <code>Layers</code> 被单独拆开成多个 <code>TileMapLayer</code> 节点了.
</p>

<p>
目前 <code>Godot</code> 还在不断的发展中, 这些变化对于我个人来说是可以接受的, 而且我认为作为 <code>Godot</code> 的用户, 也要了解版本之间一些<a href="https://docs.godotengine.org/en/stable/tutorials/migrating/index.html">重要变迁</a>(也有人指出文档目前是不完善的, 所以需要参考 <code>Godot</code> 的<a href="https://github.com/godotengine/godot/blob/master/editor/renames_map_3_to_4.cpp">源代码</a>).
</p>

<p>
这对于 <code>Godot 4</code> 的新用户来说是有益处的, 因为目前 <code>Godot 4</code> 的教程相比 <code>Godot 3</code> 的还是少很多, 如果你知道 4 和 3 的差别在哪里,
</p>

<p>
那么 3 的教程也可以使用了.
</p>
</blockquote>

<p>
然后又花了一小时 30 分左右的时间跟练完 <code>Brackeys</code> 的另外一个 <code>Godot</code> 教程: <a href="https://www.youtube.com/watch?v=e1zJS31tr88">How to program in Godot - GDScript Tutorial</a>.
</p>

<p>
这个视频时长为 58 分钟, 是让初学者快速上手 <code>GDScript</code> 的教程, 对于没有任何编程经验的人来说可能需要更长的时间完成跟练.
</p>

<blockquote>
<p>
还有一点需要注意的是, 目前 <code>Godot 4</code> 的文档上关于 <code>GDScript</code> 的 <code>ENBF</code> 还是 <code>Godot 3</code> 的, 所以不要参考上面的内容来学习 4 中的 <code>GDScript</code>.
</p>
</blockquote>

<p>
所以这就是我一天的学习轨迹了.
</p>
</div>

<div id="outline-container-orga74f146" class="outline-3">
<h3 id="orga74f146"><span class="section-number-3">1.1.</span> 心得</h3>
<div class="outline-text-3" id="text-1-1">
</div>
<div id="outline-container-org7702f69" class="outline-4">
<h4 id="org7702f69"><span class="section-number-4">1.1.1.</span> Scene 和 Node 和 Script 的关系</h4>
<div class="outline-text-4" id="text-1-1-1">
<p>
<code>Godot</code> 中一切皆为 <code>Node</code>, 一个 <code>Node</code> 又可以由若干个其它 <code>Node</code> 构成, 有时候我们想复用这个 <code>Node</code>,
</p>

<p>
那么可以把这个 <code>Node</code> 保存为一个 <code>Scene</code> 来隐藏该 <code>Node</code> 的构成细节, 并以该 <code>Scene</code> 来作为其它 <code>Node</code> 的子 <code>Node</code> 进行复用.
</p>

<p>
简单点来说 <code>Scene</code> 就是 <code>Node</code> 的封装.
</p>

<p>
<code>Script</code> 更像是 <code>Scene</code> 或 <code>Node</code> 的配置表, 它是 <code>Scene</code> 或者 <code>Node</code> 的 <code>Inspector</code> 高阶版: 通过代码编写逻辑进行配置,
</p>

<p>
基本上一切可以在 <code>Inspector</code> 上做的事情都能在 <code>Script</code> 中完成(, 注意定语"基本上").
</p>

<p>
在封装 <code>Scene</code> 对其内部根节点添加 <code>Script</code> 的话, 那么在任何场合下使用该 <code>Scene</code> 都会让 <code>Script</code> 生效, 也就是全局生效.
</p>

<p>
如果不是在封装时对 <code>Scene</code> 的内部根节点添加 <code>Script</code>, 而是在使用该 <code>Scene</code> 时为其添加 <code>Script</code>, 那么 <code>Script</code> 则不是全局生效.
</p>

<p>
按照面向对象的说法, <code>Scene</code> 封装时就是一个类, 使用该 <code>Scene</code> 时它就是一个实例.
</p>
</div>
</div>


<div id="outline-container-orgbb3f225" class="outline-4">
<h4 id="orgbb3f225"><span class="section-number-4">1.1.2.</span> 什么时候用 Node2D, 什么时候不用 Node2D</h4>
<div class="outline-text-4" id="text-1-1-2">
<p>
视频有时候会用 <code>Node</code> 作为其它节点的父节点进行分组, 而不是使用 <code>Node2D</code> 分组.
</p>

<p>
这是因为 <code>Node2D</code> 有变换相关的属性, <code>Node2D</code> 的子节点(如果这些子节点的类继承链上有 <code>Node2D</code>)会跟随着父节点 <code>Node2D</code> 进行变换.
</p>
</div>
</div>

<div id="outline-container-org891ae7a" class="outline-4">
<h4 id="org891ae7a"><span class="section-number-4">1.1.3.</span> CharacterBody2D 和 AnimatableBody2D 的使用</h4>
<div class="outline-text-4" id="text-1-1-3">
<p>
<a href="https://docs.godotengine.org/en/stable/classes/class_characterbody2d.html#description">https://docs.godotengine.org/en/stable/classes/class_characterbody2d.html#description</a>
</p>

<p>
<code>CharacterBody2D</code> 和 <code>AnimatableBody2D</code> 都提供物理实体(<code>physics bodies</code>), 物理实体并不受物理(<code>physics</code>)的影响, 物理实体只会受另外的物理实体影响.
</p>

<blockquote>
<p>
所谓的"不受物理的影响"是指不受引擎的物理属性影响, 比如重力和摩擦力.
</p>

<p>
<code>CharacterBody2D</code> 可以受到物理属性的影响, 这需要自行实现.
</p>

<p>
具体请参考文档: <a href="https://docs.godot.community/tutorials/physics/using_character_body_2d.html#what-is-a-character-body">https://docs.godot.community/tutorials/physics/using_character_body_2d.html#what-is-a-character-body</a>.
</p>
</blockquote>

<p>
<code>CharacterBody2D</code> 和 <code>AnimatableBody2D</code> 的区别在于:
</p>

<p>
<code>CharacterBody2D</code> 节点专门用于玩家控制的物体, 提供的 <code>move_and_slide()</code> 方法专门用来移动节点并进行碰撞检测, 有了这个方法开发着就能让玩家通过输入控制该节点了.
</p>

<p>
<code>AnimatableBody2D</code> 节点只提供了碰撞检测, 并没有提供 <code>move_and_slide()</code> 方法控制节点的移动, 也不受到外力(物理)影响移动, 它的移动路线一般比较固定, 通常配合<a href="https://kidscancode.org/godot_recipes/4.x/2d/moving_platforms/index.html">代码</a>或 <code>AnimationPlayer</code> 节点来实现,
</p>

<p>
玩家基本没法通过输入来控制它的移动.
</p>

<p>
因此在视频里面, <code>CharacterBody2D</code> 用来实现游戏的主角, <code>AnimatableBody2D</code> 用来实现移动的平台.
</p>

<p>
这里需要注意的是, 视频中的敌人 <code>Slime</code> 同样也是有着固定路线, 但游戏是允许玩家角色和 <code>Slime</code> 相互"重叠"的, 而不是碰撞,
</p>

<p>
所以只是使用了 <code>Area2D</code> 作为 <code>Slime</code> 的子节点用于判断玩家是否和 <code>Slime</code> 发生接触,
</p>

<p>
固定路线是结合 <code>RayCast2D</code> 来检测 <code>Slime</code> 是否与 <code>CollisionObject2D</code> 进行碰撞. <code>CollisionObject2D</code> 派生出 <code>Godot 4</code> 中所有 <code>2D</code> 物理对象类,
</p>

<p>
也就是 <code>Godot 4</code> 中所有的物体碰撞都能通过 <code>RayCast2D</code> 来检测.
</p>
</div>
</div>


<div id="outline-container-org25362b4" class="outline-4">
<h4 id="org25362b4"><span class="section-number-4">1.1.4.</span> TileMap (TileMapLayer) 的使用</h4>
<div class="outline-text-4" id="text-1-1-4">
<p>
视频很详细地描述了 <code>TileMap</code> 的使用, 如何绘制地图/背景, 以及如何为 <code>Tile</code> 设置物理层(也就是哪些 <code>Tiles</code> 需要物理碰撞, 碰撞形状如何).
</p>

<p>
视频中在制作 <code>platform</code> 时演示了启用 <code>CollisionShape2D</code> 中的 <code>one_way_collision</code> 属性来让玩家角色可以下面起跳直接穿过 <code>platform</code> 并落到 <code>platform</code> 上.
</p>

<p>
当时就在想 <code>TileMap</code> 也是否可以呢? 答案是肯定的.
</p>

<p>
视频中设置 <code>Tiles</code> 的物理层是在:
</p>

<ol class="org-ol">
<li><p>
编辑器左边的 <code>Scene</code> 栏单击选中 <code>TileMap/TileMapLayer</code>;
</p>


<div id="org9303ab0" class="figure">
<p><img src="../../../files/godot-4-select-tilemaplayer.png" alt="godot-4-select-tilemaplayer.png" />
</p>
<p><span class="figure-number">Figure 1: </span>选中 TileMapLayer</p>
</div></li>

<li><p>
双击 <code>Tiles</code> 或者点击编辑器底部的 <code>TileSet</code> 进入 <code>Tiles</code> 的编辑界面.
</p>


<div id="org660e4d8" class="figure">
<p><img src="../../../files/godot-4-go-to-tileset.png" alt="godot-4-go-to-tileset.png" />
</p>
<p><span class="figure-number">Figure 2: </span>进入 TileSet</p>
</div>

<blockquote>
<p>
视频中可能一句带过了 <code>TileSet</code> 和 <code>TileMap</code> 的作用.
</p>

<p>
这里就着重提一下:
</p>

<p>
<code>TileSet</code> 是用来设置 <code>Tiles</code> 的, 包括哪些 <code>Tiles</code> 有物理碰撞, 哪些 <code>Tiles</code> 看作一块 <code>Tile</code> 等等.
</p>

<p>
在设置好了 <code>Tiles</code> 后就可以切换到 <code>TileMap</code> 中使用 <code>Tiles</code> 对场景进行绘制.
</p>
</blockquote>

<p>
在 <code>TileSet/Paint</code> 中找到我们所设置的物理层
</p>


<div id="org1230fde" class="figure">
<p><img src="../../../files/godot4-tiles-paint-physics-layer.png" alt="godot4-tiles-paint-physics-layer.png" />
</p>
<p><span class="figure-number">Figure 3: </span>为 Tiles 设置 CollisionShape2D</p>
</div></li>
</ol>


<p>
可惜的是, <code>one_way_collision</code> 并不在 <code>TileSet/Paint</code> 中, 而是在 <code>TileSet/Select</code> 中,
</p>


<div id="orga5a818d" class="figure">
<p><img src="../../../files/godot-4-one-way-collision-in-tilemap.png" alt="godot-4-one-way-collision-in-tilemap.png" />
</p>
<p><span class="figure-number">Figure 4: </span>One Way Collision in TileSet</p>
</div>
</div>
</div>
</div>
</div>



<div id="outline-container-org8703f83" class="outline-2">
<h2 id="org8703f83"><span class="section-number-2">2.</span> Day 0: 学习 Node 的工作方式以及文档的查阅</h2>
<div class="outline-text-2" id="text-2">
<p>
在刚开始的时候对节点是不太那么熟悉的, 因此我想着找一份对各个节点有个大概介绍的资料, 阴差阳错之下在B站找到了 <a href="https://www.bilibili.com/video/BV1hf421z71a/?spm_id_from=333.999.0.0&amp;vd_source=9fdcd332c2d3e867a2fe257ff4f28e30">Godot工作流 与 Node节点</a> 这个教程,
</p>

<p>
这个教程是意外宝藏, 讲述了 <code>Godot</code> 的节点是怎么工作的, 比如加载进行内存的顺序, 初始化的顺序, 以及节点的一些重要 <code>virtual</code> 方法.
</p>

<blockquote>
<p>
为什么说是宝藏? 因为我买了 <code>GDQuest</code> 的课程, 课程并没有详细的讲到这些内容.
</p>

<p>
个人认为了解节点的工作流是很有必要的, 当然不是说 <code>GDQuest</code> 的课程不好, 实际上好多课程都没讲,
</p>

<p>
要不是因为这个教程我都不会注意到这一块的内容.
</p>
</blockquote>

<p>
<code>virtual</code> 方法是 <code>Godot</code> 中的一个概念, 意味着可以被用户覆写的方法, 换一种说法是回掉函数(<code>callbacks</code>)/钩子(<code>hooks</code>), 在特定时机下发生调用.
</p>

<p>
比如 <code>_ready()</code> 就是节点初始化完毕后就会被自动调用, <code>_tree_entered()</code> 就是节点在进入场景树(<code>SceneTree</code>)后被调用.
</p>

<p>
在<a href="https://docs.godotengine.org/en/stable/classes/class_node.html#methods">官方文档</a>的 <code>Methods</code> 中可以看到一些方法被打上 <code>virtual</code> 的标签. 另外还有 <code>const</code>, <code>vararg</code> 和 <code>static</code> 等标签来对方法做标识.
</p>

<p>
理解这些标签的含义是掌握文档使用的第一步,
</p>

<p>
<code>const</code>: 方法的调用不产生任何副作用, 也就是不改变内存. 比如 <code>print</code> 函数就是一个有副作用的例子, 因为它是改变了标准输出才能打印东西.
</p>

<p>
<code>vararg</code>: 方法接受不固定数量的参数.
</p>

<p>
<code>static</code>: 方法为静态方法(类方法), 也就是直接通过类就可以调用了, 而不是通过实例进行调用.
</p>

<p>
除了查阅在线文档以外, 也可以按 <code>F1</code> 来打开 <code>Godot Editor</code> 的帮助手册进行查阅.
</p>

<p>
还有一点需要注意的是, <code>GDScript</code> 的出现是为了让编程语言高度服务于游戏的编辑器, 在编程时可以通过鼠标 <code>hover</code> 在节点的 <code>Inspector</code> 面板上的选项名上显示出选项在 <code>GDScript</code> 中的属性名,
</p>

<p>
这个名字是可以用到编程上的(, 当然有些选项是只能在编辑器上进行设置).
</p>


<div id="orgf807566" class="figure">
<p><img src="../../../files/godot-4-hover-to-see-property-name.png" alt="godot-4-hover-to-see-property-name.png" />
</p>
<p><span class="figure-number">Figure 5: </span>鼠标hover查看属性名, 以查看 Ordering 中 Z Index 的属性名为例</p>
</div>
</div>
</div>


<div id="outline-container-orgc318c74" class="outline-2">
<h2 id="orgc318c74"><span class="section-number-2">3.</span> Day 1: 给 Brackeys 的教程例子添加额外功能</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org1cce15c" class="outline-3">
<h3 id="org1cce15c"><span class="section-number-3">3.1.</span> 视差背景 (Parallax Backgrounds)</h3>
<div class="outline-text-3" id="text-3-1">
<p>
实现参考: <a href="https://www.youtube.com/watch?v=2jq2chm9NuU">https://www.youtube.com/watch?v=2jq2chm9NuU</a>
</p>
</div>
</div>


<div id="outline-container-orgb842395" class="outline-3">
<h3 id="orgb842395"><span class="section-number-3">3.2.</span> 角色站在平台上时, 按下穿过平台回到下一层</h3>
<div class="outline-text-3" id="text-3-2">
<p>
实现参考: <a href="https://www.youtube.com/watch?v=chGgBuud_Uk">https://www.youtube.com/watch?v=chGgBuud_Uk</a>
</p>

<p>
注意这是 <code>Godot 3</code> 的教程, 但是基本上可以用在 <code>Godot 4</code> 中.
</p>

<p>
实现思路很简单, 在平台 <code>platform</code> 上添加一个 <code>Area2D</code> 节点来检测玩家角色是否站在平台上,
</p>

<p>
当检测到角色站在平台上时(会触发 <code>Area2D</code> 节点的 <code>body_entered</code> 信号)并且(通过 <code>unhandled_input</code> 方法)判断角色按了特定键, 就禁用平台的 <code>CollisionShape2D</code> 节点(<code>CollisionShape2D.disabled = true</code>),
</p>

<p>
在角色离开了 <code>Area2D</code> 的区域时(会触发 <code>Area2D</code> 节点的 <code>body_exited</code> 信号)便恢复平台的 <code>CollisionShape2D</code> 节点(<code>CollisionShape2D.disabled = false</code>).
</p>

<p>
相对于视频的方法, 本人做出了一部分调整, 没有直接修改节点 <code>Area2D</code> 的 <code>monitoring</code> 属性来控制是否有物体进入区域, 而是为 <code>platform</code> 定义了一个 <code>is_on_the_platform</code> 的变量来记录角色是否站在平台上.
</p>

<blockquote>
<p>
做完这个功能后突然冒出一个想法: 能否改变 <code>One Way Collision</code> 的方向呢?
</p>

<p>
答案是可以, <code>CollisionShape2D</code> 是 <code>Node2D</code> 的子类, 可以通过设置 <code>rotation_degrees</code> 或者 <code>rotation</code> 属性来设置旋转角度,
</p>

<p>
又或者通过 <code>rotate</code> 方法来设置旋转角度来达到改变 <code>One Way Collision</code> 的方向.
</p>

<p>
不过这并非最好的解决办法, 因为这也会改变 <code>CollisionShape2D</code> 的 <code>shape</code> 的方向.
</p>

<p>
目前<a href="https://github.com/godotengine/godot-proposals/issues/7483">官方推荐的方法</a>是使用 <code>ShapeCast2D</code> 来完成, 这个以后再尝试了.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org7969bd8" class="outline-3">
<h3 id="org7969bd8"><span class="section-number-3">3.3.</span> 添加 Game Over 界面</h3>
<div class="outline-text-3" id="text-3-3">
<p>
思路: 使用 <code>CanvasLayer</code> 节点来绘制界面, 给 <code>CanvasLayer</code> 添加一个 <code>ColorRect</code> 子节点, 再给 <code>ColorRect</code> 节点添加一个 <code>Label</code> 子节点和一个 <code>Button</code> 子节点,
</p>

<p>
<code>Label</code> 子节点用来显示 <code>Game Over</code>, <code>Button</code> 子节点用重新开始游戏.
</p>


<div id="org7e7662e" class="figure">
<p><img src="../../../files/godot-4-simple-gameover.png" alt="godot-4-simple-gameover.png" />
</p>
<p><span class="figure-number">Figure 6: </span>Godot 4 简易 Game Over 界面</p>
</div>

<p>
这里有两个细节需要注意,
</p>

<p>
一是 <code>CanvasLayer</code> 的 <code>follow_viewport_enabled</code> 属性要设置为 <code>false</code>, 这样 <code>CanvasLayer</code> 就不会跟着相机运动, 而是锚定在屏幕的固定位置.
</p>


<div id="org93ffcdb" class="figure">
<p><img src="../../../files/canvaslayer-follow-viewport-enabled-off.png" alt="canvaslayer-follow-viewport-enabled-off.png" />
</p>
<p><span class="figure-number">Figure 7: </span>禁用 CanvasLayer 的 viewport 跟随</p>
</div>

<p>
不管相机如何移动, <code>CanvasLayer</code> 都会出现在屏幕的固定位置上.
</p>

<p>
二是让 <code>ColorRect</code> 子节点占满整个屏幕, 做法很简单, 设置它的 <code>Anchor Preset</code> 属性为 <code>Full Rect</code>.
</p>


<div id="orgf4cc060" class="figure">
<p><img src="../../../files/godot-4-colorrect-fullrect.png" alt="godot-4-colorrect-fullrect.png" />
</p>
<p><span class="figure-number">Figure 8: </span>ColorRect FullRect</p>
</div>

<p>
图中这两个地方都可以设置.
</p>

<p>
剩下的就是在角色进入 <code>killzone</code> 时显示 <code>Game Over</code> 界面, 点击 <code>Game Over</code> 界面的 <code>Try again</code> 时隐藏 <code>Game Over</code> 界面并且重置游戏场景.
</p>

<p>
这部分很简单就不详细讲了.
</p>
</div>
</div>


<div id="outline-container-org0036613" class="outline-3">
<h3 id="org0036613"><span class="section-number-3">3.4.</span> 在 Game Over 时禁止用户的部分输入</h3>
<div class="outline-text-3" id="text-3-4">
<p>
现在有个问题: 显示 <code>Game Over</code> 界面后仍然能够操作角色.
</p>

<p>
解决问题就是禁止角色被操作, 我的解决思路如下:
</p>

<p>
在 <code>player.gd</code> 的 <code>_process_input(delta)</code> 调用 <code>slide_and_move()</code> 添加一个判断.
</p>

<p>
我这里进入 <code>Game Over</code> 状态时, <code>player.gd</code> 会调用 <code>set_process_input(false)</code> 方法来禁止节点的 <code>_input(event)</code> 方法调用,
</p>

<p>
重新开始游戏时调用 <code>set_process_input(true)</code> 方法恢复 <code>_input(event)</code> 方法调用.
</p>

<p>
可以通过 <code>is_processing_input()</code> 方法来获取 <code>_input(event)</code> 方法的启用状态,
</p>

<p>
因此完整的逻辑是先判断 <code>_input(event)</code> 方法的状态, 如果是启用状态那么允许调用 <code>slide_and_move()</code>;
</p>

<p>
否则, 在禁用状态下输入了 <code>jump/down/move_left/move_right</code> 其中一个动作就不再调用 <code>slide_and_move()</code>.
</p>

<p>
在判断是否输入了指定动作时, 需要使用 <code>Input.is_action_pressed(action)</code> 而不是 <code>Input.is_action_just_pressed(action)</code> 进行判断.
</p>

<p>
前者是有 <code>echo</code> 的, 也就是说如果一直按住某个 <code>action</code> 不放, 那么这个 <code>action</code> 就会以固定间隔一直触发; 后者则没有, 它只能检测用户在当前帧中的的输入,
</p>

<p>
这就是为什么 <code>jump action</code> 需要用它来判断, 我们并不需要玩家一直按着 <code>jump</code> 一直触发跳跃动作.
</p>
</div>
</div>
</div>


<div id="outline-container-org9c27bd4" class="outline-2">
<h2 id="org9c27bd4"><span class="section-number-2">4.</span> Day 2: 游戏开发中的物理</h2>
<div class="outline-text-2" id="text-4">
<p>
<a href="https://www.youtube.com/watch?v=3lBYVSplAuo">https://www.youtube.com/watch?v=3lBYVSplAuo</a>
</p>
</div>
</div>

<div id="outline-container-orgfe11ae6" class="outline-2">
<h2 id="orgfe11ae6"><span class="section-number-2">5.</span> Day 3: 给游戏的鼠标时间添加手柄支持</h2>
<div class="outline-text-2" id="text-5">
<p>
参考教程: <a href="https://www.youtube.com/watch?v=AKiA7P7NgP8">https://www.youtube.com/watch?v=AKiA7P7NgP8</a>
</p>
</div>
</div>

<div id="outline-container-org393525b" class="outline-2">
<h2 id="org393525b"><span class="section-number-2">6.</span> Day 4: GDQuest 的 Learn 2D Gamedev From Zero With Godot 4 课程学习: M4. TO SPACE AND BEYOND</h2>
<div class="outline-text-2" id="text-6">
<p>
主要是跟着课程进行练习, 整体还算简单.
</p>

<p>
个人觉得课程很多东西都讲得很详细, 在学习过 <code>Brackeys</code> 的教程并且经过复盘后, <code>GDQuest</code> 的这些入门课程很多都是一眼过.
</p>

<p>
不过 <code>GDQuest</code> 也给 <code>Brackeys</code> 里面用到的一些节点和功能进行补充, 所以总体上来说 <code>GDQuest</code> 的价格还是值得的,
</p>

<p>
也有介绍一些游戏设计方面的内容, 比如 "转向"(<code>steering</code>)以及飞船加速的实现, 并非单纯介绍引擎的使用, 不过剩下的也没什么可说的.
</p>

<p>
目前课程还在更新, 一共 19 个 <code>modules</code>, 目前更新到 <code>M9</code>.
</p>
</div>
</div>


<div id="outline-container-org6db88de" class="outline-2">
<h2 id="org6db88de"><span class="section-number-2">7.</span> Day 5: GDQuest 的 Learn 2D Gamedev From Zero With Godot 4 课程学习: M5. LOOT IT ALL</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-orgafffc11" class="outline-3">
<h3 id="orgafffc11"><span class="section-number-3">7.1.</span> 一些有趣的知识点</h3>
<div class="outline-text-3" id="text-7-1">
</div>
<div id="outline-container-org03820de" class="outline-4">
<h4 id="org03820de"><span class="section-number-4">7.1.1.</span> L3</h4>
<div class="outline-text-4" id="text-7-1-1">
</div>
<ol class="org-ol">
<li><a id="org8f77e5d"></a>改变节点的类型<br />
<div class="outline-text-5" id="text-7-1-1-1">

<div id="org50b5685" class="figure">
<p><img src="../../../files/godot-4-change-node-type.png" alt="godot-4-change-node-type.png" />
</p>
<p><span class="figure-number">Figure 9: </span>改变节点的类型</p>
</div>

<p>
如果在改变前给节点添加了脚本, 那么脚本所拓展的类型也应该跟着改变, 否则脚本会报错.
</p>
</div>
</li>

<li><a id="org9f30c66"></a>Remote 场景树<br />
<div class="outline-text-5" id="text-7-1-1-2">
<p>
在调试运行游戏时, 左边的场景树会多出 <code>Remote</code> 和 <code>Local</code> 两个选项卡.
</p>


<div id="org01f7b4a" class="figure">
<p><img src="../../../files/godot-4-remote-and-local-scene-tree.png" alt="godot-4-remote-and-local-scene-tree.png" />
</p>
<p><span class="figure-number">Figure 10: </span>Remote 和 Local 场景树</p>
</div>

<p>
如图所示, <code>Local</code> 的内容就是平时看见的场景树.
</p>


<div id="org27115e6" class="figure">
<p><img src="../../../files/godot-4-remote-scene-tree.png" alt="godot-4-remote-scene-tree.png" />
</p>
<p><span class="figure-number">Figure 11: </span>Remote 场景树</p>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2024-08-24</p>
<p class="author">Author: saltb0rn</p>
<p class="date">Created: 2024-08-31 Sat 17:32</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
